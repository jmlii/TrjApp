{% extends "layout.html" %}

{% block body %}
  <h4>Työryhmät</h4>
  <table>
    <tr>
      <th>Id</th>      
      <th>Työryhmä</th>
      <th>Oikeushyväksyjä</th>
      <th>Aktiivinen</th>
      {% if current_user.permission_id == 2 %}
      <th>Luotu</th>
      <th>Muokattu</th>
      <th>Lopetettu</th>
      {% endif %}
    </tr>
    {% for wgroup in wgroups %}
    <tr>
      <td>{{ wgroup.id }}</td>
      <td>{{ wgroup.name }}</td>
      <td>{{ wgroup.authoriser }}</td>
      <td>{{ wgroup.active }}</td>
      {% if current_user.permission_id == 2 %}
      <td>{{ wgroup.date_created }}</td>
      <td>{{ wgroup.date_modified }}</td>
      <td>{{ wgroup.date_ended }}</td>
      {% endif %}
      {% if current_user.permission_id == 2 %}
      <td>
        <form method="GET" action="{{ url_for('wgroups_update', wgroup_id=wgroup.id) }}">
          <input type="submit" value="Muokkaa tietoja"/>
        </form>
      </td>
      <td>
        <form method="POST" action="{{ url_for('wgroups_set_end', wgroup_id=wgroup.id) }}">
          <input type="submit" value="Lopeta työryhmä", onclick="return confirm('Haluatko lopettaa työryhmän ja merkitä sen epäaktiiviseksi?')"/>
        </form>
      </td>
      {% endif %}
    </tr>
    {% endfor %}
  </table>

  {% if current_user.permission_id == 2 %}

  {% if count_new_rolerequests is defined %}
  <table>
    <p></p>
    <p><b>Työryhmien uusien jäsenyyspyyntöjen lukumäärä: </b></p>
    <tr>
      <th>Työryhmä</th>
      <th>Uusia pyyntöjä</th>
    </tr>
    {% for wgroup in count_new_rolerequests %}
    <tr>
      <td>{{wgroup.name}}</td>
      <td>{{wgroup.number}} kpl</td> 
    </tr>
    {% endfor %}
  </table>
  {% endif %}

  {% if count_approved_rolerequests is defined %}
  <table>
    <p></p>
    <p><b>Työryhmien hyväksyttyjen, käsittelyä odottavien jäsenyyspyyntöjen lukumäärä: </b></p>
    <tr>
      <th>Työryhmä</th>
      <th>Odottavia pyyntöjä</th>
    </tr>
    {% for wgroup in count_approved_rolerequests %}
    <tr>
      <td>{{wgroup.name}}</td>
      <td>{{wgroup.number}} kpl</td> 
    </tr>
    {% endfor %}
  </table>
  {% endif %}

  {% endif %}

{% endblock %}